<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/controller/subsystem/job - Space Station 13</title></head><body><header><a href="index.html">Space Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/controller/subsystem/job.html#var">Var Details</a> - <a href="datum/controller/subsystem/job.html#proc">Proc Details</a></header><main><h1>job <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/job.html">job</a></aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L33"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 33"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/departments">departments</a></th><td>List of all departments</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/departments_by_name">departments_by_name</a></th><td>Dict of all departments, keys are names</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/experience_jobs_map">experience_jobs_map</a></th><td>Dictionary of jobs indexed by the experience type they grant.</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/initial_players_to_assign">initial_players_to_assign</a></th><td>var/list/datum/department/joinable_departments = list()
/ Used for checking against population caps</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/job_debug">job_debug</a></th><td>Debug info</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/job_mannequins">job_mannequins</a></th><td>Cache of icons for job info window</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/job_priorities_to_strings">job_priorities_to_strings</a></th><td>Dictionary that maps job priorities to low/medium/high. Keys have to be number-strings as assoc lists cannot be indexed by integers. Set in setup_job_lists.</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/occupations">occupations</a></th><td>List of all jobs</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/occupations_by_name">occupations_by_name</a></th><td>Dict of all jobs, keys are titles</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/occupations_by_type">occupations_by_type</a></th><td>List of all jobs datums, keys are titles</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/queries_by_key">queries_by_key</a></th><td>DOS Attack prevention by locking off file-reads.</td></tr><tr><th><a href="datum/controller/subsystem/job.html#var/unassigned">unassigned</a></th><td>Players who need jobs</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/controller/subsystem/job.html#proc/CheckHeadPositions">CheckHeadPositions</a></th><td>This proc is called at the start of the level loop of DivideOccupations() and will cause head jobs to be checked before any other jobs of the same level</td></tr><tr><th><a href="datum/controller/subsystem/job.html#proc/DivideOccupations">DivideOccupations</a></th><td></td></tr><tr><th><a href="datum/controller/subsystem/job.html#proc/FillHeadPosition">FillHeadPosition</a></th><td>This proc is called before the level loop of DivideOccupations() and will try to select a head, ignoring ALL non-head preferences for every level until it locates a head or runs out of levels to check</td></tr><tr><th><a href="datum/controller/subsystem/job.html#proc/check_job_eligibility">check_job_eligibility</a></th><td>Runs a standard suite of eligibility checks to make sure the player can take the reqeusted job.</td></tr><tr><th><a href="datum/controller/subsystem/job.html#proc/get_spawnpoint_for">get_spawnpoint_for</a></th><td>Return appropriate /datum/spawnpoint for given client and rank</td></tr><tr><th><a href="datum/controller/subsystem/job.html#proc/job_priority_level_to_string">job_priority_level_to_string</a></th><td>Takes a job priority #define such as JP_LOW and gets its string representation for logging.</td></tr><tr><th><a href="datum/controller/subsystem/job.html#proc/setup_job_lists">setup_job_lists</a></th><td>Builds various lists of jobs based on station, centcom and additional jobs with icons associated with them.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/departments"><aside class="declaration">var </aside>departments <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L45"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 45"></a></h3><p>List of all departments</p><h3 id="var/departments_by_name"><aside class="declaration">var </aside>departments_by_name <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L47"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 47"></a></h3><p>Dict of all departments, keys are names</p><h3 id="var/experience_jobs_map"><aside class="declaration">var </aside>experience_jobs_map <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L66"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 66"></a></h3><p>Dictionary of jobs indexed by the experience type they grant.</p><h3 id="var/initial_players_to_assign"><aside class="declaration">var </aside>initial_players_to_assign <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L58"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 58"></a></h3><p>var/list/datum/department/joinable_departments = list()
/ Used for checking against population caps</p><h3 id="var/job_debug"><aside class="declaration">var </aside>job_debug <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L51"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 51"></a></h3><p>Debug info</p><h3 id="var/job_mannequins"><aside class="declaration">var </aside>job_mannequins <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L53"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 53"></a></h3><p>Cache of icons for job info window</p><h3 id="var/job_priorities_to_strings"><aside class="declaration">var </aside>job_priorities_to_strings <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L63"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 63"></a></h3><p>Dictionary that maps job priorities to low/medium/high. Keys have to be number-strings as assoc lists cannot be indexed by integers. Set in setup_job_lists.</p><h3 id="var/occupations"><aside class="declaration">var </aside>occupations <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L39"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 39"></a></h3><p>List of all jobs</p><h3 id="var/occupations_by_name"><aside class="declaration">var </aside>occupations_by_name <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L41"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 41"></a></h3><p>Dict of all jobs, keys are titles</p><h3 id="var/occupations_by_type"><aside class="declaration">var </aside>occupations_by_type <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L43"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 43"></a></h3><p>List of all jobs datums, keys are titles</p><h3 id="var/queries_by_key"><aside class="declaration">var </aside>queries_by_key <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L61"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 61"></a></h3><p>DOS Attack prevention by locking off file-reads.</p><h3 id="var/unassigned"><aside class="declaration">var </aside>unassigned <aside>– /list</aside> <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L49"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 49"></a></h3><p>Players who need jobs</p><h2 id="proc">Proc Details</h2><h3 id="proc/CheckHeadPositions"><aside class="declaration">proc </aside>CheckHeadPositions<aside>(level)  <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L352"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 352"></a></aside></h3><p>This proc is called at the start of the level loop of DivideOccupations() and will cause head jobs to be checked before any other jobs of the same level</p><h3 id="proc/DivideOccupations"><aside class="declaration">proc </aside>DivideOccupations<aside>()  <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L368"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 368"></a></aside></h3><ul>
<li>Proc DivideOccupations</li>
<li>fills var &quot;assigned_role&quot; for all ready players.</li>
<li>This proc must not have any side effect besides of modifying &quot;assigned_role&quot;.</li>
</ul><h3 id="proc/FillHeadPosition"><aside class="declaration">proc </aside>FillHeadPosition<aside>()  <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L314"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 314"></a></aside></h3><p>This proc is called before the level loop of DivideOccupations() and will try to select a head, ignoring ALL non-head preferences for every level until it locates a head or runs out of levels to check</p><h3 id="proc/check_job_eligibility"><aside class="declaration">proc </aside>check_job_eligibility<aside>(/<a href="mob.html">mob</a>/<a href="mob/new_player.html">new_player</a>/player, /<a href="datum.html">datum</a>/<a href="datum/job.html">job</a>/possible_job, debug_prefix, add_job_to_log)  <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L99"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 99"></a></aside></h3><p>Runs a standard suite of eligibility checks to make sure the player can take the reqeusted job.</p>
<p>Checks:</p>
<ul>
<li>Role bans</li>
<li>How many days old the player account is</li>
<li>Whether the player has the required hours in other jobs to take that role</li>
<li>If the job is in the mind's restricted roles, for example if they have an antag datum that's incompatible with certain roles.</li>
</ul>
<p>Arguments:</p>
<ul>
<li>player - The player to check for job eligibility.</li>
<li>possible_job - The job to check for eligibility against.</li>
<li>debug_prefix - Logging prefix for the JobDebug log entries. For example, GRJ during GiveRandomJob or DO during DivideOccupations.</li>
<li>add_job_to_log - If TRUE, appends the job type to the log entry. If FALSE, does not. Set to FALSE when check is part of iterating over players for a specific job, set to TRUE when check is part of iterating over jobs for a specific player and you don't want extra log entry spam.</li>
</ul><h3 id="proc/get_spawnpoint_for"><aside class="declaration">proc </aside>get_spawnpoint_for<aside>(/<a href="client.html">client</a>/C, rank, late)  <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L699"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 699"></a></aside></h3><p>Return appropriate /datum/spawnpoint for given client and rank</p>
<p>Spawnpoint will be the one set in preferences for the client, unless the
preference is not set, or the preference is not appropriate for the rank, in
which case a fallback will be selected.</p><h3 id="proc/job_priority_level_to_string"><aside class="declaration">proc </aside>job_priority_level_to_string<aside>(priority)  <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L81"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 81"></a></aside></h3><p>Takes a job priority #define such as JP_LOW and gets its string representation for logging.</p><h3 id="proc/setup_job_lists"><aside class="declaration">proc </aside>setup_job_lists<aside>()  <a href="https://github.com/Monkestation/Monkeris/blob/5ef4b17a02510dbcb672640e142a1bf9afd9b110/code/controllers/subsystems/jobs.dm#L777"><img src="git.png" width="16" height="16" title="code/controllers/subsystems/jobs.dm 777"></a></aside></h3><p>Builds various lists of jobs based on station, centcom and additional jobs with icons associated with them.</p></main><footer>cev_eris.dme <a href="https://github.com/Monkestation/Monkeris/tree/5ef4b17a02510dbcb672640e142a1bf9afd9b110">5ef4b17</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.10.0</a></footer></body></html>